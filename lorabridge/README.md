# LoraBridge Messenger

LoraBridge превращает Meshtastic‑узлы в полноценного собеседника Telegram. Проект нужен операторам, которые работают с
LoRa‑сетями в поле: один участник общается через радиомодем, другой — через Telegram‑бота. Мост подхватывает сообщения из обеих
сторон, синхронизирует ID пользователей и гарантирует доставку, даже если сеть или железо работает нестабильно.

## Текущее состояние
- **Двусторонний обмен:** реализованы очереди для входящих и исходящих сообщений, обработчики Telegram и Meshtastic, менеджер ID.
- **CLI и команды:** `python -m src.main` запускает мост, показывает состояние и позволяет очистить очереди.
- **Журналы и базы:** все события пишутся в `data/logs`, а соответствие Telegram ↔ Meshtastic сохраняется в `data/users.json`.
- **Документация:** подробные сценарии описаны в `docs/README_RU.md` и `docs/wiki/*`.

## В ближайших планах
- Графический интерфейс управления, где оператор увидит состояние всех очередей и устройств.
- Отправка медиа и вложений в обе стороны.
- Расширение набора команд, автоматическая диагностика ошибок, интеграция с дополнительными LoRa‑сетями.

## Быстрый старт и мастер настройки
1. Установите Python 3.11+, Git и зависимости Meshtastic.
2. Клонируйте репозиторий и перейдите в директорию моста:
   ```bash
   git clone <repo-url>
   cd MESHGRAM/lorabridge
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   pip install -r requirements.txt
   ```
3. Запустите мост или команду `status`. Перед первым стартом появится интерактивный мастер:
   ```bash
   python -m src.main run      # запускает мастер + мост
   python -m src.main status   # запускает мастер + выводит текущие параметры
   ```
   Мастер попросит авторизовать Telegram‑бота (введите токен прямо в консоль), предложит выбрать COM‑порт из списка найденных
   устройств и сохранит все параметры (`.env`, `config/settings.json`). Никаких `echo TELEGRAM_TOKEN=...` и ручного редактирования
   больше не требуется — при следующем запуске мастер предложит использовать уже сохранённые значения.

После настройки команда `run` поднимает очередь сообщений и выводит сервисные логи. Командой `flush` можно вручную очистить
накопленные сообщения, а все остальные параметры редактируются через мастер или через файлы в `config/`.

## Структура
| Путь | Назначение |
| --- | --- |
| `src/` | Исходники Telegram/Meshtastic клиентов, очередей и утилит. |
| `config/` | Настройки мастера и сохранённый `.env`. |
| `data/` | Журналы и соответствие пользователей. |
| `docs/` | Подробная документация и схемы. |
| `tests/` | Юнит‑тесты для очередей и менеджера пользователей. |

Дополнительные материалы см. в `docs/wiki/architecture.md`, `docs/wiki/delivery_logic.md` и `docs/wiki/future_plans.md`.
