# Система идентификаторов

1. **Автовыдача** — при первом сообщении Telegram-пользователя вызывается `UserMappingStore.assign`, который создаёт запись и ID `#N`.
2. **TTL** — записи живут 48 часов с момента последнего сообщения. Если пользователь активен, время обновляется.
3. **Перезапуск** — файл `data/users.json` сохраняет `sequence` и список пользователей, поэтому после рестарта ID сохраняется.
4. **Очистка** — метод `cleanup` автоматически удаляет просроченные записи. Запущен при каждом обращении к хранилищу.
5. **Команды** — `/ulist` выводит текущие соответствия, `/history` (план) будет опираться на те же ID.
